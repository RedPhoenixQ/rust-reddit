{let e,t,{fromEntries:r,entries:o,keys:l,getPrototypeOf:n}=Object,{get:f,set:i,deleteProperty:y,ownKeys:a}=Reflect,{state:s,derive:c,add:m,tags:d}=van,b=n(s()),u=1e3,S=Symbol(),g=Symbol(),w=Symbol(),p=Symbol(),v=Symbol(),P=Symbol(),A=e=>(e[w]=1,e),D=e=>e?.[w]?c(()=>O(e())):s(O(e)),O=e=>{if(!(e instanceof Object)||e[S])return e;let t=new Proxy((e[S]=r(o(e).map(([e,t])=>[e,D(t)])),e[g]=e,e[p]=[],e[v]=s(1),e),{get:(e,r)=>n(e[S][r]??0)===b?e[S][r].val:("length"===r&&e[v].val,f(e,r,t)),set(e,r,o){let l=e[S];if(r in l)return l[r].val=O(o),1;let n=r in e,f=n&&"length"===r&&o!==e.length;return i(e,r,o)?(n?f&&++e[v].val:i(l,r,D(o))&&(++e[v].val,k(t,r,l[r])),1):void 0},deleteProperty:(e,t)=>(y(e[S],t)&&x(e,t),y(e,t)&&++e[v].val),ownKeys:e=>(e[v].val,a(e))});return t},_=e=>e[S],h=e=>e[p]=e[p].filter(e=>e.t.isConnected),j=(e,t,r,o)=>()=>{let l=o(r,()=>delete e[t],t);return l[P]=t,l},K=(e,t,r,{t:o,f:n},f)=>{if(m(o,j(e,t,r,n)),!f&&Array.isArray(e)&&t!=e.length-1){let t={};for(let e of o.childNodes)t[e[P]]=e;let r=o.firstChild;for(let n of l(e))r===t[n]?r=r.nextSibling:o.insertBefore(t[n],r)}},k=(e,r,o)=>h(e).forEach(K.bind(t,e,r,o)),x=(e,t)=>{for(let r of h(e))[...r.t.childNodes].find(e=>e[P]===t)?.remove()},E=r=>(e??(setTimeout(()=>(e.forEach(h),e=t),u),e=new Set)).add(r),F=(e,t,r)=>{let l={t:e(),f:r};t[p].push(l),E(t);for(let[e,r]of o(t[S]))K(t,e,r,l,1);return l.t},R=(e,t)=>{let l=Array.isArray(e)?o(t(e.filter(e=>1))):t(o(e)),n=e[g],f=r(l),i=e[S],y=r(l.map(([e,t])=>{let r=i[e];return r?r.val=O(t):r=D(t),[e,r]}));for(let{t:t,f:r}of h(e)){let l={};for(let e of[...t.childNodes])e[P]in y?l[e[P]]=e:e.remove();let n=t.firstChild;for(let[f,i]of o(y))n===l[f]?n=n.nextSibling:t.insertBefore(l[f]??d.div(j(e,f,i,r)).firstChild,n)}for(let e in n)delete n[e];Array.isArray(n)&&(n.length=0);for(let e in f)n[e]=f[e];e[S]=y,++e[v].val};window.vanX={calc:A,reactive:O,stateFields:_,list:F,replace:R}}